import copy

from linear_genetic_programming._instruction import Instruction
from linear_genetic_programming._program_multi import ProgramMulti
from linear_genetic_programming._program_rev import ProgramRev
from linear_genetic_programming._program import Program
from linear_genetic_programming._statistics import Statistics
from linear_genetic_programming._two_input_boolean_funcs import TwoInputBooleanFuncs
from linear_genetic_programming._two_input_boolean_funcs_new import TwoInputBooleanFuncsNew
class EnumeratorForRandomWalk:
    RANDOM_WALK_STEP = 10000
    def get_dict(self, target_pheno):
        res_dict_conv = {}
        res_dict_rev = {}
        res_dict_multi = {}
        for i in range(100):
            sequence = []
            for m in range(4):
                instr = Instruction()
                instr.makeRandInstr(4, 2, 2)
                sequence.append(instr)
            
            prog_con = Program()
            prog_con.makeDetermProg(sequence)
            
            pheno_cur = TwoInputBooleanFuncs.phenotype(prog_con)
            prog_update = copy.deepcopy(prog_con)
            find = False
            for j in range(self.RANDOM_WALK_STEP):
                prog_update = TwoInputBooleanFuncs.one_step_mutation(prog_update)
                if TwoInputBooleanFuncs.phenotype(prog_update) == target_pheno:
                    res_dict_conv[pheno_cur] = res_dict_conv.get(pheno_cur, []) + [j]
                    find = True
                    break
            if not find:
                res_dict_conv.get(pheno_cur, []) + [self.RANDOM_WALK_STEP + 1]

            prog_rev = ProgramRev()
            prog_rev.makeDetermProg(sequence)

            pheno_cur = TwoInputBooleanFuncsNew.phenotype(prog_rev)
            prog_update = copy.deepcopy(prog_rev)
            find = False
            for j in range(self.RANDOM_WALK_STEP):
                prog_update = TwoInputBooleanFuncsNew.one_step_mutation(prog_update)
                if TwoInputBooleanFuncsNew.phenotype(prog_update) == target_pheno:
                    res_dict_rev[pheno_cur] = res_dict_rev.get(pheno_cur, []) + [j]
                    find = True
                    break
            if not find:
                res_dict_rev.get(pheno_cur, []) + [self.RANDOM_WALK_STEP + 1]


            prog_multi = ProgramMulti()
            prog_multi.makeDetermProg(sequence)

            pheno_cur = TwoInputBooleanFuncsNew.phenotype(prog_multi)
            prog_update = copy.deepcopy(prog_rev)
            find = False
            for j in range(self.RANDOM_WALK_STEP):
                prog_update = TwoInputBooleanFuncsNew.one_step_mutation(prog_update)
                if TwoInputBooleanFuncsNew.phenotype(prog_update) == target_pheno:
                    res_dict_multi[pheno_cur] = res_dict_multi.get(pheno_cur, []) + [j]
                    find = True
                    break
            if not find:
                res_dict_multi.get(pheno_cur, []) + [self.RANDOM_WALK_STEP + 1]

        return res_dict_conv, res_dict_rev, res_dict_multi

    @staticmethod
    def get_avg(dic):
        avg = {}
        for key1, value1 in dic.items():
            for key2, value2 in value1.items():
                avg[(key1, key2)] = Statistics.mean(value2)
        return avg

if __name__ == "__main__":
    final_dict_conv = {}
    final_dict_rev = {}
    final_dict_multi = {}
    for i in range(16):
        print(i)
        random_walk = EnumeratorForRandomWalk()
        final_dict_conv[i] = random_walk.get_dict(i)[0]
        final_dict_rev[i] = random_walk.get_dict(i)[1]
        final_dict_multi[i] = random_walk.get_dict(i)[2]
    print(EnumeratorForRandomWalk.get_avg(final_dict_conv))
    print(EnumeratorForRandomWalk.get_avg(final_dict_rev))
    print(EnumeratorForRandomWalk.get_avg(final_dict_multi))

'''
{(0, 10): 15.5, (0, 3): 19.333333333333332, (0, 8): 25.0, (0, 5): 11.0, (0, 14): 20.428571428571427, (0, 15): 12.058823529411764, (0, 0): 4.538461538461538, (0, 2): 9.333333333333334, (0, 1): 11.833333333333334, (0, 11): 16.0, (0, 12): 18.5, (0, 7): 29.0, (0, 13): 2.0, (0, 4): 3.0, (1, 15): 38.63636363636363, (1, 8): 32.0, (1, 12): 63.1, (1, 5): 35.125, (1, 10): 52.714285714285715, (1, 14): 30.125, (1, 0): 64.36363636363636, (1, 11): 97.0, (1, 3): 57.666666666666664, (1, 2): 82.0, (1, 1): 0.4, (1, 7): 46.75, (1, 4): 167.0, (2, 8): 134.375, (2, 1): 26.0, (2, 15): 196.56521739130434, (2, 10): 125.57142857142857, (2, 12): 194.1, (2, 0): 167.95238095238096, (2, 13): 150.66666666666666, (2, 14): 112.4, (2, 3): 192.0, (2, 2): 11.0, (2, 5): 250.28571428571428, (2, 4): 55.0, (2, 7): 91.66666666666667, (2, 11): 430.0, (3, 0): 33.88235294117647, (3, 7): 31.2, (3, 15): 39.666666666666664, (3, 8): 45.0, (3, 5): 42.53333333333333, (3, 12): 49.166666666666664, (3, 3): 8.555555555555555, (3, 10): 40.5, (3, 14): 59.75, (3, 1): 56.5, (3, 2): 124.0, (3, 13): 58.0, (3, 4): 35.0, (3, 11): 14.0, (4, 11): 77.0, (4, 3): 140.9375, (4, 15): 172.11764705882354, (4, 5): 177.0, (4, 0): 150.1, (4, 12): 187.0, (4, 1): 218.66666666666666, (4, 14): 138.55555555555554, (4, 2): 40.5, (4, 10): 256.1666666666667, (4, 13): 2.0, (4, 8): 63.25, (4, 4): 9.0, (4, 7): 85.5, (5, 0): 27.636363636363637, (5, 15): 30.88888888888889, (5, 1): 43.25, (5, 10): 51.0, (5, 5): 6.454545454545454, (5, 3): 54.75, (5, 7): 19.2, (5, 12): 38.81818181818182, (5, 2): 63.0, (5, 14): 30.666666666666668, (5, 11): 103.0, (5, 8): 20.75, (6, 15): 3255.3333333333335, (6, 0): 3185.5333333333333, (6, 12): 4367.0, (6, 14): 3304.6666666666665, (6, 3): 5008.75, (6, 10): 7713.5, (6, 1): 2722.5, (6, 13): 229.0, (6, 7): 4431.0, (6, 4): 864.0, (6, 5): 6109.333333333333, (6, 8): 7187.0, (7, 14): 130.22222222222223, (7, 5): 40.36363636363637, (7, 3): 74.75, (7, 1): 78.85714285714286, (7, 12): 37.166666666666664, (7, 15): 111.71428571428571, (7, 10): 38.875, (7, 0): 93.64285714285714, (7, 8): 60.666666666666664, (7, 13): 93.0, (7, 7): 0.0, (7, 4): 3.0, (7, 11): 31.0, (8, 0): 70.42857142857143, (8, 15): 77.31818181818181, (8, 12): 69.91666666666667, (8, 1): 37.25, (8, 10): 55.8, (8, 5): 63.55555555555556, (8, 11): 114.0, (8, 8): 23.0, (8, 14): 41.666666666666664, (8, 3): 93.2, (8, 7): 43.666666666666664, (8, 2): 63.0, (8, 4): 39.0, (8, 13): 42.0, (9, 12): 5027.666666666667, (9, 7): 3913.0, (9, 3): 3776.4, (9, 10): 4981.4, (9, 5): 2932.375, (9, 1): 2471.8333333333335, (9, 0): 3134.2727272727275, (9, 14): 4228.833333333333, (9, 8): 2475.0, (9, 15): 3576.1666666666665, (9, 13): 4493.0, (9, 4): 1986.0, (10, 0): 28.74074074074074, (10, 15): 62.84615384615385, (10, 3): 39.333333333333336, (10, 10): 1.5714285714285714, (10, 5): 17.8, (10, 14): 41.833333333333336, (10, 12): 43.18181818181818, (10, 4): 8.0, (10, 1): 36.666666666666664, (10, 7): 26.0, (10, 8): 17.0, (10, 2): 28.0, (10, 11): 7.0, (11, 15): 119.5, (11, 0): 176.1304347826087, (11, 10): 194.0, (11, 3): 98.2, (11, 5): 186.22222222222223, (11, 13): 57.0, (11, 12): 110.66666666666667, (11, 8): 60.285714285714285, (11, 7): 102.5, (11, 4): 191.0, (11, 1): 199.0, (11, 14): 344.5, (12, 0): 44.96153846153846, (12, 5): 43.0, (12, 15): 36.80952380952381, (12, 10): 33.45454545454545, (12, 12): 5.375, (12, 7): 40.0, (12, 14): 72.25, (12, 13): 12.0, (12, 3): 52.375, (12, 1): 21.75, (12, 8): 46.25, (12, 11): 30.0, (12, 2): 55.0, (13, 3): 201.83333333333334, (13, 14): 251.2, (13, 10): 183.66666666666666, (13, 13): 0.6666666666666666, (13, 5): 190.75, (13, 0): 137.0, (13, 15): 71.84615384615384, (13, 8): 161.66666666666666, (13, 7): 113.88888888888889, (13, 1): 362.0, (13, 12): 174.33333333333334, (13, 11): 47.25, (14, 10): 75.375, (14, 5): 67.66666666666667, (14, 15): 58.19047619047619, (14, 14): 10.333333333333334, (14, 0): 65.23809523809524, (14, 7): 123.5, (14, 8): 35.2, (14, 11): 149.5, (14, 3): 100.57142857142857, (14, 13): 88.5, (14, 4): 9.0, (14, 12): 84.75, (14, 2): 54.0, (14, 1): 39.77777777777778, (15, 15): 10.166666666666666, (15, 0): 16.954545454545453, (15, 3): 24.181818181818183, (15, 1): 32.5, (15, 10): 43.0, (15, 14): 4.666666666666667, (15, 12): 18.3, (15, 2): 48.5, (15, 5): 17.0, (15, 7): 16.166666666666668, (15, 11): 7.666666666666667, (15, 8): 10.5, (15, 4): 16.0, (15, 13): 1.0}
{(0, 8): 11.0, (0, 7): 17.166666666666668, (0, 0): 1.608695652173913, (0, 14): 21.625, (0, 15): 15.333333333333334, (0, 1): 11.88888888888889, (0, 10): 26.0, (0, 13): 15.666666666666666, (0, 12): 7.125, (0, 11): 27.0, (0, 5): 16.666666666666668, (0, 2): 23.0, (0, 4): 2.0, (0, 3): 48.5, (1, 7): 42.0, (1, 12): 33.875, (1, 14): 27.714285714285715, (1, 5): 17.928571428571427, (1, 15): 58.72222222222222, (1, 10): 57.57142857142857, (1, 11): 62.75, (1, 2): 59.5, (1, 3): 139.2, (1, 13): 76.0, (1, 8): 60.166666666666664, (1, 0): 72.38095238095238, (1, 1): 0.0, (2, 14): 173.75, (2, 12): 199.0, (2, 1): 79.33333333333333, (2, 3): 159.9, (2, 11): 56.0, (2, 5): 208.4, (2, 0): 175.16, (2, 8): 222.0, (2, 7): 151.5, (2, 13): 66.0, (2, 15): 112.0, (2, 10): 158.54545454545453, (2, 2): 62.0, (3, 7): 21.2, (3, 12): 26.692307692307693, (3, 14): 26.77777777777778, (3, 5): 59.25, (3, 4): 83.0, (3, 0): 44.36363636363637, (3, 8): 45.7, (3, 3): 4.909090909090909, (3, 10): 41.42857142857143, (3, 15): 19.846153846153847, (3, 13): 73.0, (3, 2): 8.0, (3, 1): 75.0, (4, 0): 115.34782608695652, (4, 15): 116.93333333333334, (4, 12): 146.0, (4, 10): 166.66666666666666, (4, 5): 190.42857142857142, (4, 14): 189.6, (4, 3): 126.63636363636364, (4, 8): 73.71428571428571, (4, 1): 124.5, (4, 7): 164.6, (4, 2): 189.0, (4, 13): 83.5, (5, 8): 49.375, (5, 15): 35.588235294117645, (5, 14): 36.5, (5, 11): 88.5, (5, 6): 1.0, (5, 10): 28.846153846153847, (5, 1): 42.375, (5, 0): 58.142857142857146, (5, 3): 25.333333333333332, (5, 12): 33.0, (5, 5): 12.666666666666666, (5, 13): 0.0, (5, 2): 7.0, (5, 9): 30.0, (6, 1): 6534.25, (6, 15): 3337.9, (6, 10): 6674.5, (6, 0): 4863.111111111111, (6, 5): 4875.25, (6, 12): 6497.4, (6, 3): 1110.0, (6, 7): 9201.0, (6, 14): 8643.0, (7, 5): 53.5, (7, 12): 62.125, (7, 3): 101.35714285714286, (7, 7): 29.833333333333332, (7, 10): 67.18181818181819, (7, 15): 60.38461538461539, (7, 8): 39.3, (7, 4): 24.0, (7, 11): 90.0, (7, 1): 8.333333333333334, (7, 0): 47.77777777777778, (7, 14): 171.66666666666666, (7, 2): 5.0, (8, 0): 54.61904761904762, (8, 7): 49.0, (8, 15): 43.76470588235294, (8, 1): 94.5, (8, 13): 22.0, (8, 5): 59.36363636363637, (8, 3): 65.375, (8, 14): 66.57142857142857, (8, 12): 52.3, (8, 10): 34.125, (8, 8): 23.25, (8, 2): 13.5, (8, 11): 196.0, (9, 1): 3727.6666666666665, (9, 11): 1607.0, (9, 0): 3553.6, (9, 7): 6211.75, (9, 10): 3634.2, (9, 15): 3985.714285714286, (9, 5): 6563.5, (9, 3): 3349.285714285714, (9, 14): 6741.0, (9, 8): 36.0, (9, 12): 7140.0, (10, 11): 4.0, (10, 3): 61.142857142857146, (10, 0): 46.03846153846154, (10, 14): 20.857142857142858, (10, 10): 10.8, (10, 12): 47.285714285714285, (10, 8): 12.0, (10, 7): 37.5, (10, 15): 33.06666666666667, (10, 1): 29.666666666666668, (10, 5): 26.8, (10, 13): 20.0, (10, 4): 50.0, (11, 15): 120.2, (11, 0): 179.63636363636363, (11, 10): 184.45454545454547, (11, 3): 105.33333333333333, (11, 1): 125.0, (11, 14): 122.71428571428571, (11, 12): 171.83333333333334, (11, 8): 173.5, (11, 5): 153.75, (11, 7): 105.33333333333333, (11, 4): 111.0, (11, 13): 108.0, (11, 11): 0.0, (12, 7): 35.0, (12, 0): 33.57142857142857, (12, 3): 8.23076923076923, (12, 10): 29.25, (12, 15): 28.42105263157895, (12, 12): 10.714285714285714, (12, 11): 15.333333333333334, (12, 4): 16.0, (12, 8): 32.5, (12, 1): 65.5, (12, 14): 28.5, (12, 5): 38.5, (12, 13): 26.0, (13, 8): 195.83333333333334, (13, 10): 196.72727272727272, (13, 2): 154.0, (13, 14): 144.55555555555554, (13, 0): 148.23529411764707, (13, 5): 139.0, (13, 3): 139.27272727272728, (13, 15): 212.1, (13, 12): 114.125, (13, 1): 167.0, (13, 7): 36.142857142857146, (13, 4): 92.0, (13, 13): 0.0, (14, 5): 37.84615384615385, (14, 15): 67.11111111111111, (14, 3): 58.125, (14, 12): 26.2, (14, 14): 31.142857142857142, (14, 0): 64.84210526315789, (14, 13): 38.25, (14, 10): 46.25, (14, 1): 40.5, (14, 4): 22.0, (14, 7): 50.142857142857146, (14, 8): 169.33333333333334, (14, 2): 88.0, (15, 7): 11.2, (15, 11): 10.0, (15, 5): 13.909090909090908, (15, 3): 16.833333333333332, (15, 15): 7.733333333333333, (15, 2): 11.6, (15, 12): 20.1, (15, 10): 15.5, (15, 0): 28.666666666666668, (15, 14): 12.0, (15, 1): 20.125, (15, 8): 32.0, (15, 4): 15.5}
{(0, 8): 8.285714285714286, (0, 3): 16.0, (0, 1): 20.25, (0, 0): 1.894736842105263, (0, 11): 38.5, (0, 15): 14.285714285714286, (0, 5): 16.5, (0, 12): 13.8, (0, 10): 23.2, (0, 14): 26.25, (0, 13): 58.5, (0, 7): 31.0, (0, 2): 0.0, (1, 5): 91.88888888888889, (1, 2): 117.0, (1, 3): 28.166666666666668, (1, 0): 67.46153846153847, (1, 8): 71.66666666666667, (1, 12): 81.14285714285714, (1, 15): 40.36363636363637, (1, 10): 32.0, (1, 14): 42.833333333333336, (1, 1): 24.4, (1, 7): 30.0, (1, 11): 10.0, (2, 12): 68.5, (2, 0): 172.08333333333334, (2, 5): 176.91666666666666, (2, 3): 67.875, (2, 15): 123.0625, (2, 10): 139.4, (2, 7): 203.5, (2, 1): 134.0, (2, 14): 134.71428571428572, (2, 4): 51.0, (2, 8): 118.33333333333333, (2, 13): 130.0, (2, 11): 282.5, (2, 2): 68.0, (3, 2): 90.0, (3, 0): 22.5, (3, 10): 46.833333333333336, (3, 8): 89.66666666666667, (3, 15): 44.95, (3, 7): 35.0, (3, 5): 50.4, (3, 3): 1.25, (3, 12): 38.53846153846154, (3, 4): 22.5, (3, 13): 6.0, (3, 1): 4.5, (3, 14): 48.0, (3, 11): 4.5, (4, 14): 92.125, (4, 0): 177.7, (4, 1): 208.75, (4, 5): 183.5, (4, 15): 103.66666666666667, (4, 3): 166.0, (4, 12): 289.9, (4, 8): 392.6666666666667, (4, 11): 71.25, (4, 2): 112.0, (4, 10): 158.71428571428572, (4, 13): 20.0, (4, 7): 120.71428571428571, (5, 15): 59.76470588235294, (5, 12): 40.0, (5, 0): 67.73684210526316, (5, 5): 17.285714285714285, (5, 3): 32.0, (5, 10): 37.9, (5, 8): 54.333333333333336, (5, 7): 16.5, (5, 14): 22.5, (5, 1): 60.75, (5, 13): 42.5, (6, 3): 3857.3333333333335, (6, 7): 5235.666666666667, (6, 15): 4462.142857142857, (6, 8): 2646.3333333333335, (6, 10): 4479.6, (6, 5): 3163.5555555555557, (6, 0): 5781.833333333333, (6, 1): 2782.0, (6, 12): 4850.0, (6, 11): 5759.0, (6, 2): 8778.0, (6, 14): 3823.0, (7, 1): 98.18181818181819, (7, 12): 59.285714285714285, (7, 0): 80.42857142857143, (7, 5): 84.84615384615384, (7, 2): 83.5, (7, 3): 110.44444444444444, (7, 15): 85.84615384615384, (7, 4): 47.0, (7, 10): 49.81818181818182, (7, 11): 38.0, (7, 7): 21.333333333333332, (7, 8): 67.75, (7, 14): 66.0, (7, 13): 2.0, (8, 1): 51.5, (8, 12): 85.44444444444444, (8, 0): 77.82352941176471, (8, 10): 53.5, (8, 14): 47.0, (8, 7): 59.0, (8, 4): 15.0, (8, 8): 6.0, (8, 3): 46.57142857142857, (8, 5): 64.15384615384616, (8, 11): 152.5, (8, 15): 83.0, (8, 13): 12.5, (8, 2): 29.5, (9, 0): 3279.6, (9, 15): 4746.1, (9, 14): 2640.8, (9, 5): 1660.0, (9, 12): 5621.333333333333, (9, 10): 5670.833333333333, (9, 7): 3293.0, (9, 1): 4733.0, (9, 11): 3730.6666666666665, (9, 2): 813.5, (9, 8): 6378.0, (9, 3): 5200.333333333333, (10, 9): 24.0, (10, 7): 32.81818181818182, (10, 2): 6.0, (10, 0): 46.5, (10, 15): 39.333333333333336, (10, 5): 27.125, (10, 10): 2.75, (10, 12): 40.77777777777778, (10, 14): 26.0, (10, 3): 35.166666666666664, (10, 11): 50.333333333333336, (10, 1): 6.666666666666667, (10, 8): 9.75, (10, 4): 1.5, (11, 1): 167.0, (11, 15): 115.13333333333334, (11, 0): 221.16666666666666, (11, 3): 93.0, (11, 14): 141.16666666666666, (11, 8): 89.4, (11, 5): 206.66666666666666, (11, 4): 173.5, (11, 11): 0.0, (11, 12): 95.6, (11, 10): 128.5, (11, 7): 57.666666666666664, (11, 13): 171.0, (11, 2): 307.0, (12, 1): 33.42857142857143, (12, 0): 41.05, (12, 5): 51.5, (12, 15): 21.375, (12, 2): 32.333333333333336, (12, 12): 8.181818181818182, (12, 3): 21.125, (12, 13): 59.333333333333336, (12, 14): 27.0, (12, 4): 8.75, (12, 10): 32.75, (12, 7): 22.75, (12, 11): 6.0, (12, 8): 30.5, (13, 0): 158.4, (13, 11): 86.0, (13, 13): 14.8, (13, 3): 122.7, (13, 8): 161.54545454545453, (13, 7): 68.0, (13, 4): 513.0, (13, 5): 84.25, (13, 15): 52.0, (13, 1): 104.57142857142857, (13, 10): 130.75, (13, 12): 112.36363636363636, (13, 14): 235.75, (14, 4): 82.0, (14, 1): 71.4, (14, 0): 53.888888888888886, (14, 8): 74.375, (14, 15): 58.0, (14, 12): 86.14285714285714, (14, 14): 20.0, (14, 5): 55.81818181818182, (14, 7): 129.0, (14, 3): 74.6, (14, 10): 30.444444444444443, (14, 2): 17.0, (14, 13): 74.0, (15, 10): 16.076923076923077, (15, 5): 19.875, (15, 1): 26.571428571428573, (15, 13): 6.5, (15, 7): 21.142857142857142, (15, 12): 10.3, (15, 15): 2.142857142857143, (15, 0): 21.40909090909091, (15, 14): 6.714285714285714, (15, 3): 42.8, (15, 11): 12.0, (15, 4): 1.0}
'''